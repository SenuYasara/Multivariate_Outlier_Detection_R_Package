---
output: github_document
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```


```{r, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(mgcv)
library(MOutliers)
library(usethis)
library(testthat)
use_testthat()
```


# Multivariate Outlier Detection Package

## Introduction

An outlier can be defined as an observation or subset of observations that appears to be inconsistent with the rest of the data and do not fit into the overall trend. They may appear due to various reasons, including mistakes in data collection or recording, natural variation, or the representation of uncommon but valid data points. In statistics and data science, identifying outliers is an essential preprocessing step to ensure the robustness and accuracy of analyses. While univariate outliers can often be detected easily, multivariate outliers which result from complex interactions among multiple variables are more difficult to identify. If those hidden anomalies are not properly addressed, they can bias model conclusions and significantly degrade model performance. Therefore, multivariate outlier detection plays a vital role in the statistical analysis of multidimensional data.

The package is designed to include several useful components. It offers three distinct techniques for identifying outliers in multivariate data: Mahalanobis Distance, Minimum Covariance Determinant, and Principal Component Analysis-based distance.The program makes use of the Rcpp package's C++ integration, which speeds up computations and makes handling bigger datasets possible.Furthermore, the package incorporates pairwise plots that highlight possible outliers to improve the interpretability of results for those without a background in statistics. 

## Installation

The package can be installed directly from GitHub using the `devtools` package. 

```r
# Install devtools if not already installed
install.packages("devtools")

# Install the MOutliers package from GitHub (with tests)
devtools::install_github("SenuYasara/Multivariate_Outlier_Detection_R_Package",
  INSTALL_opts = "--install-tests"
)
```

Once installed, the package can be loaded in R as follows:

```r
library(MOutliers)
```

To run the included unit tests after installation:

```r
library(testthat)
test_package("MOutliers")
```

These tests confirm that the functions `detect_multivariate_outliers()` and `plot_outliers()` behave as expected, producing correct outputs and handling invalid inputs appropriately.


## Example Usage

### Function: detect_multivariate_outliers()

#### Example 1: Simulated Data

This example demonstrates detecting multivariate outliers using simulated data.

```{r, echo=TRUE}
set.seed(123)
df <- data.frame(
  x = c(rnorm(50), 5),
  y = c(rnorm(50), 5)
)
head(df)
```

```{r, echo=TRUE}
# Mahalanobis Distance

result_mahal <- detect_multivariate_outliers(df, method = "mahalanobis", alpha = 0.975)
head(result_mahal)
```

```{r, echo=TRUE}
# Minimum Covariance Determinant (MCD)

result_mcd <- detect_multivariate_outliers(df, method = "mcd", alpha = 0.975)
head(result_mcd)
```

```{r, echo=TRUE}
# Principal Component Analysis (PCA)

result_pca <- detect_multivariate_outliers(df, method = "pca", alpha = 0.975)
head(result_pca)
```

#### Example 2: Existing Dataset (mtcars)

This example demonstrates detecting multivariate outliers using a real dataset (mtcars) with three variables: mpg, hp, and wt.

```{r, echo=TRUE}
df_mtcars <- mtcars[, c("mpg", "hp", "wt" )]
head(df_mtcars)
```

```{r, echo=TRUE}
# Mahalanobis Distance

result_mahal <- detect_multivariate_outliers(df_mtcars, method = "mahalanobis"
                                             ,alpha = 0.975)
head(result_mahal)
```

```{r, echo=TRUE}
# Minimum Covariance Determinant (MCD)

result_mcd <- detect_multivariate_outliers(df_mtcars, method = "mcd", alpha = 0.975)
head(result_mcd)
```

```{r, echo=TRUE}
# Principal Component Analysis (PCA)

result_pca <- detect_multivariate_outliers(df_mtcars, method = "pca", alpha = 0.975)
head(result_pca)
```


### Function: plot_outliers()

#### Example 1: Simulated Data

This example demonstrates visualizing 2D scatterplots for each pair of variable in the dataset using simulated data.

```{r, echo=TRUE, fig.width=6.5, fig.height=6.5, fig.align='center'}
# Mahalanobis Distance
plot_outliers(df, method = "mahalanobis", alpha = 0.975)
```


```{r, echo=TRUE, fig.width=6.5, fig.height=6.5, fig.align='center'}
# Minimum Covariance Determinant (MCD)
plot_outliers(df, method = "mcd", alpha = 0.975)
```


#### Example 2: Existing Dataset (mtcars)

This example demonstrates visualizing 2D scatterplots for each pair of variable in the dataset using a real dataset (mtcars) with three variables: mpg, hp, and wt.

```{r, echo=TRUE, fig.width=6.5, fig.height=6.5, fig.align='center'}
# Mahalanobis Distance
plot_outliers(df_mtcars, method = "mahalanobis", alpha = 0.975)
```


```{r, echo=TRUE, fig.width=6.5, fig.height=6.5, fig.align='center'}
# Minimum Covariance Determinant (MCD)
plot_outliers(df_mtcars, method = "mcd", alpha = 0.975)
```

